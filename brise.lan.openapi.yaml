openapi: 3.0.4
info:
  title: Brise LAN API
  version: 3.0.0
  contact:
    name: AGST
    email: ped@agst.com.br
    url: https://www.agst.com.br
  description: |
    A **Brise LAN API** √© a interface para comunica√ß√£o direta com dispositivos Brise dentro de uma mesma rede local, sem necessidade de conex√£o com a internet.  
    Projetada para ambientes onde a lat√™ncia, confiabilidade ou seguran√ßa s√£o cr√≠ticas, ela permite o controle e monitoramento local de dispositivos Brise por meio de chamadas HTTP/HTTPS diretamente ao dispositivo na mesma rede.

    Todos os dados s√£o trocados no formato **JSON**, seguindo padr√µes RESTful, facilitando a integra√ß√£o com sistemas de automa√ß√£o residencial, industrial e predial que operam offline ou exigem resposta em tempo real.

    ### Funcionalidades Principais

    - **Comunica√ß√£o direta com dispositivos Brise** na rede local  
    - **Controle imediato** de opera√ß√µes  
    - **Leitura de status e m√©tricas em tempo real** sem intermedi√°rios  
    - **Opera√ß√£o independente do servi√ßo** ‚Äî ideal para ambientes isolados ou restritos  

    A API utiliza autentica√ß√£o simples e n√£o depende de servi√ßos externos, garantindo disponibilidade cont√≠nua mesmo sem acesso √† internet.

    ### Quando usar a Brise LAN API?

    Esta API √© recomendada nos seguintes cen√°rios:
    - Falhas frequentes ou aus√™ncia de conectividade com a internet.
    - Necessidade de baixa lat√™ncia no controle (ex: automa√ß√£o cr√≠tica).
    - Pol√≠ticas de seguran√ßa que pro√≠bem ou restringem tr√°fego via internet.

    > ‚ö†Ô∏è **Importante**: A Brise Local API opera apenas dentro da rede local. O endere√ßo IP do dispositivo ou gateway Brise deve ser conhecido e acess√≠vel pela aplica√ß√£o cliente.

    Para integra√ß√µes h√≠bridas, combine esta API com a **Brise Cloud API** e mantenha o controle local com supervis√£o remota.

    # üîê Autentica√ß√£o

    Este t√≥pico descreve os m√©todos de autentica√ß√£o dispon√≠veis e como utiliz√°-los.  

    <!-- ReDoc-Inject: <security-definitions> -->

servers:
  - url: "http://{device-ip}/api/v3"
    description: Dispositivo Brise na rede local (substitua {device-ip})

tags:
  - name: Rede
    description: Opera√ß√µes relacionadas √† configura√ß√£o e status da rede do dispositivo Brise.

paths:
  /network/wifi:
    put:
      tags:
        - Rede
      summary: Configura Wi-Fi
      description: |
        Define o SSID e a senha da rede Wi-Fi √† qual o dispositivo Brise deve se conectar.  
        Ap√≥s a atualiza√ß√£o, o dispositivo tentar√° conectar automaticamente √† nova rede.

        > ‚ö†Ô∏è Durante o processo de troca de rede, a conex√£o atual ser√° interrompida.  
        > O dispositivo aplicar√° as novas credenciais e reiniciar√° o m√≥dulo de rede.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - ssid
                - password
              properties:
                ssid:
                  type: string
                  description: Nome da rede Wi-Fi (SSID)
                  example: "RedeBrise"
                password:
                  type: string
                  description: Senha da rede Wi-Fi
                  example: "12345678"
      responses:
        "200":
          description: Configura√ß√£o aplicada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
              examples:
                sucesso:
                  summary: Exemplo de sucesso
                  value:
                    success: true
        "400":
          description: Requisi√ß√£o inv√°lida. Verifique os dados enviados.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
    get:
      tags:
        - Rede
      summary: Lista redes Wi-Fi
      description: |
        Retorna a lista mais recente de redes Wi-Fi detectadas pelo dispositivo.  
        O dispositivo executa varreduras autom√°ticas periodicamente (a cada 30 segundos), mantendo a lista atualizada em cache.
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Lista de redes encontradas
          content:
            application/json:
              schema:
                type: object
                properties:
                  networks:
                    type: array
                    items:
                      type: object
                      properties:
                        ssid:
                          type: string
                          example: "RedeBrise"
                        rssi:
                          type: integer
                          example: -62
                        security:
                          type: string
                          example: "WPA2"
                        channel:
                          type: integer
                          example: 6
              examples:
                exemplo:
                  summary: Exemplo de resposta
                  value:
                    networks:
                      - ssid: "RedeBrise"
                        rssi: -62
                        security: "WPA2"
                        channel: 6
                      - ssid: "RedeAGST"
                        rssi: -78
                        security: "WPA3"
                        channel: 11
  /network/wifi/scan:
    post:
      tags:
        - Rede
      summary: Scan Wi-Fi
      description: |
        Solicita ao dispositivo que execute imediatamente uma nova varredura Wi-Fi, atualizando o cache de redes observadas.  

        > üïí A opera√ß√£o √© ass√≠ncrona: a lista pode levar alguns segundos para refletir as novas redes detectadas.  
        > Use `GET /network/wifi` para verificar quando o cache for atualizado.
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Varredura iniciada com sucesso
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
              examples:
                sucesso:
                  summary: Exemplo de sucesso
                  value:
                    success: true
        "409":
          description: J√° existe uma varredura em andamento
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: ALREADY_IN_PROGRESS
components:
  securitySchemes:
    bearerAuth:
      title: Bearer Authentication
      type: http
      scheme: bearer
      description: |
        O token de acesso deve ser enviado no cabe√ßalho `Authorization` da sua requisi√ß√£o autenticadas.

        ```
        Authorization: Bearer <seu-token>
        ```
  schemas:
    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          example: INVALID_REQUEST
